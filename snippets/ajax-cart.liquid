<div id="theme-ajax-cart" class="theme-ajax-cart shopify-section {% if context == 'mobile-header' %}jsAjaxCart{% endif %} is-{{ settings.cart_action | replace: '_', '-' }} theme-ajax-cart--header-{{ settings.header_layout }}" data-ajax-cart-{{ settings.cart_action }}>
  <section class="ajax-cart ajax-cart--{{ settings.cart_action | replace: '_', '-' }}">
    {% comment %} Inner ajax cart content can be found in templates/cart.ajax.liquid {% endcomment %}

    {% if settings.cart_action == 'mini_cart' %}
      <div class="card has-shadow">
        <div class="ajax-cart__close-icon" data-ajax-cart-close>
          {% include settings.icon, name: 'x' %}
        </div>
        <div id="ajax-cart__content" data-ajax-cart-content></div>
      </div>
    {% elsif settings.cart_action == 'drawer' %}
      <div class="ajax-cart__close-icon" data-ajax-cart-close>
        {% include settings.icon, name: 'x' %}
      </div>
      <div id="ajax-cart__content" data-ajax-cart-content></div>
    {% endif %}
  </section>

  {% comment %}JavaScript{% endcomment %}
  <script
    type="application/json"
    data-section-id="theme-ajax-cart"
    data-section-data
  >
    {
      "cart_action": {{ settings.cart_action | json }},
      "display_tos_checkbox": {{ settings.display_tos_checkbox | json }}
    }
  </script>
  <script src="{{ 'z__jsAjaxCart.js' | asset_url }}"></script>
</div>

{% if settings.cart_action == 'drawer' %}
  <div class="ajax-cart__overlay" data-ajax-cart-close></div>
{% endif %}

<style>
 #AjaxifyCart .additional-checkout-buttons, #ajaxifyCart .additional-checkout-buttons {
    display:none;
}
</style>
{% if template != 'cart'  %}
    <script src='//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js'></script>
	<script>
	rjQuery = jQuery.noConflict( true );
    var subscription_active='{{shop.metafields.subscriptions.subscription_active}}'
    function get_cookie(k){return(document.cookie.match('(^|; )'+k+'=([^;]*)')||0)[2]}
    if (get_cookie('recharge')=='true' || subscription_active=='true') { 
        rjQuery('body').on('click','form[action="/checkout"] input[type="submit"], #ajaxifyCart [name="checkout"], #AjaxifyCart [name="checkout"], #shoppingBagInner [name="checkout"]', function(e){
            e.preventDefault();           	        
            window.location.href = '/cart';
        })
        rjQuery('.additional-checkout-buttons').hide()
        rjQuery(document).ready(function(){
            rjQuery('.additional-checkout-buttons').hide()
        })
    }
      
      rjQuery('body').on('click','.button--minicart-checkout', function(e){
        e.preventDefault();
        const noteInput = rjQuery(this).closest('form').find('textarea.ajax-cart__note').val();
        const submitBtn = rjQuery(this).closest('form').find('button[type="submit"]');
        console.log(noteInput);
        $.ajax({
          type: "POST",
          url: '/cart.js',
          data: {"note": noteInput},
          success: function(d) {
            submitBtn.trigger('click');
          },
          dataType: 'json'
        });
      });
      
    </script>
{% endif %}