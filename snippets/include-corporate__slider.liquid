{% comment %}
  Snippet can be used in section or block
  eg. {% include 'include-testimonial' %}
{% endcomment %}

{% comment %}Assign object as block or section{% endcomment %}
{% if type == 'block' %}
  {% assign object = block %}
{% else %}
  {% assign object = section %}
{% endif %}

{% assign id = object.id %}
{% comment %}Layout{% endcomment %}
{% assign width = object.settings.width %}
{% assign padding_top = object.settings.padding_top %}
{% assign padding_bottom = object.settings.padding_bottom %}
{% assign animation = object.settings.animation | default: 'none' %}
{% assign card_text = object.settings.card_text %}
{% assign card_background = object.settings.card_background %}
{% comment %} Advanced {% endcomment %}
{% assign css_class = object.settings.css_class %}
{% assign custom_css = object.settings.custom_css %}

{% comment %} Is the color set to transparent? {% endcomment %}
{% assign card_text_alpha = card_text | color_extract: 'alpha' %}
{% assign card_background_alpha = card_background | color_extract: 'alpha' %}


{% capture section_css -%}

  .testimonial-block {
    border-radius: 5px;
    background-color: {%- if card_background_alpha != 0 -%}{{ card_background }}{%- endif -%};
  }

  .testimonial__description {
    color: {{ card_text }};
  }
{%- endcapture -%}


{% style %}
  #shopify-section-{{ id }} {
    padding-top: {{ padding_top }}px;
    {% if width == 'wide' %}
      width: 100%;
    {% endif %}

    background-color: {{ object.settings.background }};
  }
  #shopify-section-{{ id }}  section {
    padding-bottom: {{ padding_bottom }}px;
    position: relative;
  }
  {% include 'css-loop', css: section_css, id: id %}
  {% include 'css-loop', css: custom_css, id: id %}
{% endstyle %}

<section class="section
                {{ css_class }}
                is-width-{{ width }}
                {% if section.blocks.size <= 1 %}desktop-slider--disabled{% endif %}
                "
          {% if animation != "none" %}
            data-scroll-class="{{ animation }}"
          {% endif %}>

          {% if section.blocks.size > 1 %}
            <div style="display: none">
              <div class="testimonial__nav testimonial__nav--prev">
                <img src="{{ 'red-arrow-left.svg' | asset_url }}" />
              </div>
              <div class="testimonial__nav testimonial__nav--next ">
                <img src="{{ 'red-arrow-right.svg' | asset_url }}" />
              </div>
            </div>
          {% endif %}
    
  {% if object.settings.section_title != blank %}
  <h1 class="testimonial_title">{{ object.settings.section_title }}</h1>
  {% endif %}

  <div class="testimonials container" data-testimonial-slider >

    {% for block in section.blocks %}

    {% comment %} Is the color set to transparent? {% endcomment %}
    {% assign info_text_alpha = block.settings.info_text | color_extract: 'alpha' %}
    {% assign info_background_alpha = block.settings.info_background | color_extract: 'alpha' %}

    <div id="shopify-section-{{ block.id }}"
         class="testimonial-block
                block--{{ block.id }}
                column
                has-images-enabled-{{ section.settings.enable_images }}
                testimonial-border--{{ section.settings.show_border }}
                testimonial-align--{{ section.settings.card_alignment }}
                {% include 'column-width', value: 'one-whole' %}
                medium-down--one-whole" data-testimonial-index={{ forloop.index0 }} {{ block.shopify_attributes }}>

      <style>
          .block--{{ block.id }} .testimonial__name {
            color: {%- if info_text_alpha != 0 -%}{{ block.settings.info_text }}{%- endif -%};
            background-color: {%- if info_background_alpha != 0 -%}{{ block.settings.info_background }}{% else %}{{ settings.shop_bg_color }}{%- endif -%};
          }
      </style>

      <div class="one-third medium-down--one-whole ">
        <div class="testimonial__description">
          {% if block.settings.title != blank %}
          <div class="testimonial__description-title title">
            {{ block.settings.title }}
          </div>
          {% endif %}

          {% if block.settings.percent != blank %}
          <div class="testimonial__description__review">
            <div class="circle_percent">
              {{ block.settings.percent }}
            </div>
          </div>
          {% endif %}

          <div class="testimonial__description-quote">
            {{ block.settings.quote }}
          </div>
        </div>

        <div class="testimonial__name">
          <div class="middle">
            {{ block.settings.text }}       
          </div> 
        </div>
      </div>

      <div class="two-thirds medium-down--one-whole  testimonial__image has-image-crop image-style--{{ section.settings.crop_shape }}">
          {% if section.settings.enable_images == true %}
            {% if block.settings.image != blank %}
              {% include 'image-element', image: block.settings.image, alt: block.settings.image.alt %}
            {% else %}
              {{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}
            {% endif %}
          {% endif %}
        </div>

    </div>
    {% endfor %}
  </div>
</section>
{% if section.settings.show_wave_border %}
<div class="product-header-wave">
  {% include 'include-wave_background', color: 'white' %}
</div>
{% endif %}

{% comment %}JavaScript{% endcomment %}
<script
  type="application/json"
  data-section-id="{{ object.id }}"
  data-section-data
>
  {
  }
</script>
<script data-theme-editor-load-script src="{{ 'z__jsTestimonials.js' | asset_url }}"></script>
